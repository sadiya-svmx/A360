<template>
    <div class="full-height slds-grid slds-grid_vertical slds-card">
        <template if:true={error}>
            <c-alert
                variant="error"
                class="svmx-entitlement-common-settings_custom-alert"
            >
                {error}
            </c-alert>
        </template>
        <div class="slds-page-header list-view-header">
            <div class="slds-page-header__row">
                <div class="slds-page-header__col-title">
                    <div class="slds-media">
                        <div class="slds-media__figure">
                            <c-service-max-logo-icon
                                title-text={i18n.entitlement}
                                alternative-text={i18n.entitlement}
                                icon-size="large"
                            ></c-service-max-logo-icon>
                        </div>
                        <div class="slds-media__body">
                            <div class="slds-page-header__name">
                                <div class="slds-page-header__name-title">
                                    <h1>
                                        <span>
                                            {i18n.entitlement}
                                        </span>
                                        <span
                                            class="slds-page-header__title slds-truncate" 
                                            title={i18n.settings}
                                        >
                                            {i18n.settings}
                                        </span>
                                    </h1>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="slds-page-header__col-actions">
                    <div class="slds-page-header__controls">
                        <div class="slds-page-header__control">
                            <lightning-button-group>
                                <lightning-button
                                    label={i18n.save}
                                    title={i18n.save}
                                    variant="brand"
                                    onclick={handleSave}
                                    class="svmx-entitlement-common-settings_save-btn"
                                    disabled={disableSaveBtn}
                                ></lightning-button>
                            </lightning-button-group>
                            <lightning-button-icon
                                icon-name="utility:help"
                                variant="bare"
                                alternative-text={i18n.help}
                                title={i18n.help}
                                onclick={handleHelpClick}
                                class="svmx-help-link-button slds-m-left_x-small"
                            ></lightning-button-icon>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="slds-p-horizontal_large slds-p-vertical_xx-large">
            <div class="slds-media slds-m-bottom_x-large">
                <div class="slds-media__figure slds-m-right_none">
                    <lightning-input
                        class="svmx-entitlement-common-settings_input-field svmx-entitlement-common-settings_assign-entitled-service-field"
                        type="checkbox"
                        name="assignEntitledService"
                        checked={commonSetting.assignEntitledService}
                        variant="label-hidden"
                        onchange={handleValueChange}
                    ></lightning-input>
                </div>
                <div class="slds-media__body">
                    <label class="slds-m-bottom_small">
                        {i18n.labelAssignEntitledService}
                    </label>
                    <p class="slds-grid slds-grid_vertical-align-center slds-m-top_x-small">
                        {i18n.helpTextAssignEntitledService}
                    </p>
                </div>
            </div>

            <div class="slds-media slds-m-bottom_x-large">
                <div class="slds-media__figure slds-m-right_none">
                    <lightning-input
                        class="svmx-entitlement-common-settings_input-field svmx-entitlement-common-settings_inherit-service-work-order-field"
                        type="checkbox"
                        name="inheritServiceOnWorkOrder"
                        checked={commonSetting.inheritServiceOnWorkOrder}
                        variant="label-hidden"
                        onchange={handleValueChange}
                    ></lightning-input>
                </div>
                <div class="slds-media__body">
                    <label class="slds-m-bottom_small">
                        {i18n.labelInheritServiceOnWorkOrder}
                    </label>
                    <p class="slds-grid slds-grid_vertical-align-center slds-m-top_x-small">
                        {i18n.helpTextInheritServiceOnWorkOrder}
                    </p>
                </div>
            </div>
    
            <div class="slds-media slds-m-bottom_x-large">
                <div class="slds-media__figure slds-m-right_none">
                    <lightning-input
                        class="svmx-entitlement-common-settings_input-field svmx-entitlement-common-settings_inherit-service-return-order-field"
                        type="checkbox"
                        name="inheritServiceOnReturnOrder"
                        variant="label-hidden"
                        checked={commonSetting.inheritServiceOnReturnOrder}
                        onchange={handleValueChange}
                    ></lightning-input>
                </div>
                <div class="slds-media__body">
                    <label class="slds-m-bottom_small">
                        {i18n.labelInheritServiceOnReturnkOrder}
                    </label>
                    <p class="slds-grid slds-grid_vertical-align-center slds-m-top_x-small">
                        {i18n.helpTextInheritServiceOnReturnOrder}
                    </p>
                </div>
            </div>

            <div class="slds-media slds-m-bottom_x-large">
                <div class="slds-media__figure slds-m-right_none">
                    <lightning-input
                        class="svmx-entitlement-common-settings_input-field svmx-entitlement-common-settings_assign-pricebook-field"
                        type="checkbox"
                        name="assignPricebook"
                        variant="label-hidden"
                        checked={commonSetting.assignPricebook}
                        onchange={handleValueChange}
                    ></lightning-input>
                </div>
                <div class="slds-media__body">
                    <label class="slds-m-bottom_small">
                        {i18n.labelAssignPricebook}
                    </label>
                    <p class="slds-grid slds-grid_vertical-align-center slds-m-top_x-small">
                        {i18n.helpTextAssignPricebook}
                    </p>
                </div>
            </div>

            <div class="slds-media slds-m-bottom_x-large">
                <div class="slds-media__figure slds-m-right_none">
                    <lightning-input
                        class="svmx-entitlement-common-settings_input-field svmx-entitlement-common-settings_decerement-service-count-field"
                        type="checkbox"
                        name="adjustServiceThreshold"
                        variant="label-hidden"
                        checked={commonSetting.adjustServiceThreshold}
                        onchange={handleValueChange}
                    ></lightning-input>
                </div>
                <div class="slds-media__body">
                    <label class="slds-m-bottom_small">
                        {i18n.labelAdjustServiceThreshold}
                    </label>
                    <p class="slds-grid slds-grid_vertical-align-center">
                        {i18n.labelAdjustVisitCountAssignedObject}
                        <template if:true={diableVisitCountAssignedObject}>
                            <c-combobox
                                variant="label-hidden"
                                data-field="adjustVisitCountAssignedObject"
                                value={commonSetting.adjustVisitCountAssignedObject}
                                items={adjustVisitCountAssignedObjectOptions}
                                onchange={handleComboboxChange}
                                class="slds-m-left_small svmx-entitlement-common-settings_input-field svmx-entitlement-common-settings_decerement-object-field"
                                disabled
                                filterable
                            ></c-combobox>
                        </template>

                        <template if:false={diableVisitCountAssignedObject}>
                            <c-combobox
                                variant="label-hidden"
                                data-field="adjustVisitCountAssignedObject"
                                value={commonSetting.adjustVisitCountAssignedObject}
                                items={adjustVisitCountAssignedObjectOptions}
                                onchange={handleComboboxChange}
                                class="slds-m-left_small svmx-entitlement-common-settings_input-field svmx-entitlement-common-settings_decerement-object-field"
                                required
                                filterable
                            ></c-combobox>
                        </template>
                    </p>
                </div>
            </div>

            <c-x-expandable-section title="Stack Ranking">

                <div class="slds-media slds-m-top_medium slds-m-bottom_medium">
                    <div class="slds-media__figure slds-m-right_none">
                        <lightning-input
                            class="svmx-entitlement-common-settings_input-field svmx-entitlement-common-settings_stack-ranking-field"
                            type="checkbox"
                            name="applyStackRanking"
                            variant="label-hidden"
                            checked={commonSetting.applyStackRanking}
                            onchange={handleValueChange}
                        ></lightning-input>
                    </div>
                    <div class="slds-media__body">
                        <label class="slds-m-bottom_small">
                            {i18n.applyStackRanking}
                        </label>
                    </div>
                </div>

                <div class="slds-form">

                    <div class="slds-form-element slds-form-element_stacked slds-size_1-of-2">
                        <label class="slds-form-element__label">{i18n.stackRankingContractField}</label>

                        <template if:true={disableApplyStackRanking}>
                            <c-combobox
                                variant="label-hidden"
                                data-field="contractStackRankingAPIName"
                                value={commonSetting.contractStackRankingAPIName}
                                items={contractStackRankingAPINameOptions}
                                onchange={handleComboboxChange}
                                class="slds-m-left_small svmx-entitlement-common-settings_input-field svmx-entitlement-common-settings_contract-stack-field"
                                disabled
                                filterable
                            ></c-combobox>
                        </template>

                        <template if:false={disableApplyStackRanking}>
                            <c-combobox
                                variant="label-hidden"
                                data-field="contractStackRankingAPIName"
                                value={commonSetting.contractStackRankingAPIName}
                                items={contractStackRankingAPINameOptions}
                                onchange={handleComboboxChange}
                                class="slds-m-left_small svmx-entitlement-common-settings_input-field svmx-entitlement-common-settings_contract-stack-field"
                                required
                                filterable
                            ></c-combobox>
                        </template>
                    </div>

                    <div class="slds-form-element slds-form-element_stacked slds-size_1-of-2">
                        <label class="slds-form-element__label">{i18n.stackRankingContractSortOrder}</label>
                        <template if:true={disableApplyStackRanking}>
                            <c-combobox
                                variant="label-hidden"
                                data-field="contractStackRankingOrder"
                                value={commonSetting.contractStackRankingOrder}
                                items={contractStackRankingOrderOptions}
                                onchange={handleComboboxChange}
                                class="slds-m-left_small svmx-entitlement-common-settings_input-field svmx-entitlement-common-settings_contract-stack-order-field"
                                disabled
                                filterable
                            ></c-combobox>
                        </template>

                        <template if:false={disableApplyStackRanking}>
                            <c-combobox
                                variant="label-hidden"
                                data-field="contractStackRankingOrder"
                                value={commonSetting.contractStackRankingOrder}
                                items={contractStackRankingOrderOptions}
                                onchange={handleComboboxChange}
                                class="slds-m-left_small svmx-entitlement-common-settings_input-field svmx-entitlement-common-settings_contract-stack-order-field"
                                required
                                filterable
                            ></c-combobox>
                        </template>
                    </div>

                    <div class="slds-form-element slds-form-element_stacked slds-size_1-of-2">
                        <label class="slds-form-element__label">{i18n.stackRankingWarrantyField}</label>
                        <template if:true={disableApplyStackRanking}>
                            <c-combobox
                                variant="label-hidden"
                                data-field="warrantyStackRankingAPIName"
                                value={commonSetting.warrantyStackRankingAPIName}
                                items={warrantyStackRankingAPINameOptions}
                                onchange={handleComboboxChange}
                                class="slds-m-left_small svmx-entitlement-common-settings_input-field svmx-entitlement-common-settings_warranty-stack-field"
                                disabled
                                filterable
                            ></c-combobox>
                        </template>

                        <template if:false={disableApplyStackRanking}>
                            <c-combobox
                                variant="label-hidden"
                                data-field="warrantyStackRankingAPIName"
                                value={commonSetting.warrantyStackRankingAPIName}
                                items={warrantyStackRankingAPINameOptions}
                                onchange={handleComboboxChange}
                                class="slds-m-left_small svmx-entitlement-common-settings_input-field svmx-entitlement-common-settings_warranty-stack-field"
                                required
                                filterable
                            ></c-combobox>
                        </template>
                    </div>

                    <div class="slds-form-element slds-form-element_stacked slds-size_1-of-2">
                        <label class="slds-form-element__label">{i18n.stackRankingWarrantySortOrder}</label>
                        <template if:true={disableApplyStackRanking}>
                            <c-combobox
                                variant="label-hidden"
                                data-field="warrantyStackRankingOrder"
                                value={commonSetting.warrantyStackRankingOrder}
                                items={warrantyStackRankingOrderOptions}
                                onchange={handleComboboxChange}
                                class="slds-m-left_small svmx-entitlement-common-settings_input-field svmx-entitlement-common-settings_warranty-stack-order-field"
                                disabled
                                filterable
                            ></c-combobox>
                        </template>

                        <template if:false={disableApplyStackRanking}>
                            <c-combobox
                                variant="label-hidden"
                                data-field="warrantyStackRankingOrder"
                                value={commonSetting.warrantyStackRankingOrder}
                                items={warrantyStackRankingOrderOptions}
                                onchange={handleComboboxChange}
                                class="slds-m-left_small svmx-entitlement-common-settings_input-field svmx-entitlement-common-settings_warranty-stack-order-field"
                                required
                                filterable
                            ></c-combobox>
                        </template>
                    </div>

                </div>

            </c-x-expandable-section>

        </div>

        <template if:true={apiInProgress}>
            <lightning-spinner
                variant="brand"
                alternative-text={i18n.loading}
            ></lightning-spinner>
        </template>
    </div>
</template>